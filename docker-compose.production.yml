# Production deployment for Hostinger VPS with Traefik
# Deploy using: Hostinger API or docker-compose up -d

services:
  scheduler:
    build: .
    container_name: hypefury-scheduler
    restart: unless-stopped
    expose:
      - "8080"
    environment:
      - PORT=8080
      - HF_API_KEY=${HF_API_KEY}
    volumes:
      - scheduler_data:/app/data
    labels:
      - traefik.enable=true
      - traefik.http.routers.hypefury.rule=Host(`scheduler.srv1176124.hstgr.cloud`)
      - traefik.http.routers.hypefury.tls=true
      - traefik.http.routers.hypefury.entrypoints=web,websecure
      - traefik.http.routers.hypefury.tls.certresolver=mytlschallenge
      - traefik.http.services.hypefury.loadbalancer.server.port=8080
    networks:
      - root_default
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

volumes:
  scheduler_data:
    driver: local

networks:
  root_default:
    external: true
